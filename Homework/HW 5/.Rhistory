breaks = .5*(0:20),
dig.lab = 5)) %>%
count(cellID, bin) %>%
summarize(fano = ( var(n) / mean(n)))
spike.fano
spike.fano <- allSpikes.df %>%
group_by(cellID) %>%
mutate(bin = cut(spikes,
breaks = .5*(0:20),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin)))) %>%
summarize(fano = ( var(count) / mean(count)))
spike.fano
spike.fano <- allSpikes.df %>%
group_by(cellID) %>%
mutate(bin = cut(spikes,
breaks = .5*(0:20),
dig.lab = 5))
spike.fano
spike.fano <- allSpikes.df %>%
group_by(cellID) %>%
mutate(bin = cut(spikes,
breaks = .5*(0:20),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin))))
spike.fano
View(spike.fano)
spike.fano <- allSpikes.df %>%
group_by(cellID) %>%
mutate(bin = cut(spikes,
breaks = .5*(0:20),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin)))) %>%
summarize(fano = ( var(count) / mean(count)))
spike.fano
wdd <- setwd('~/Downloads')
library('ggplot2')
library(tidyverse)
# set up empty data frame to hold spike times and cell ID
allSpikes.df <- data.frame(spikes = NULL, cellID = NULL)
# read in data
for (i in seq(1,10))
{
spike.df <- read_csv(paste0("spikeTimes_neuron",i,"_M1cortex.csv")) %>%
mutate(cellID = factor(i))
allSpikes.df <- rbind(allSpikes.df, spike.df)
}
# only keep the two columns I want: spikes and cellID
allSpikes.df <- allSpikes.df[c("spikes","cellID")]
start <- 3.5 #start of stim  -- seconds
stop <- 4.5 #end of stim  -- seconds
T <- 10 # total time of trial -- seconds
N <- 10 # number of spike trains
##########################
### Spike raster plot ####
##########################
spikeTrain <- allSpikes.df %>%
ggplot() +
geom_tile(aes(x = spikes, y = cellID), width = 0.02, height = 0.6) +
annotate("rect", xmin = start, xmax = stop, ymin = 0, ymax = N+0.5, fill = "purple", color ="black", alpha = 0.4)+
labs(x = "Time (seconds)", y = "Cell ID", title = "Spike raster") +
theme_classic()
spikeTrain
before.df <- allSpikes.df %>%
filter(spikes<start) %>%
mutate(stimID = "before")
during.df <- allSpikes.df %>%
filter(spikes>=start & spikes <= stop) %>%
mutate(stimID = "during")
after.df <- allSpikes.df %>%
filter(spikes>stop) %>%
mutate(stimID = "after")
# put that column onto allSpikes
allSpikes.df <- rbind(before.df, during.df, after.df)
# bin width
dt <- 0.25;
pop.firingRate.df <- allSpikes.df %>%
group_by(stimID) %>%
mutate(bins = cut(spikes, breaks = seq(0,T,dt), dig.lab = 5)) %>%
summarise(count = as.vector(table(bins)), bins = as.vector(names(table(bins))))%>%
mutate(countPerNeuron = count/N) %>%
mutate(FR = count/(dt*N))
popFR_histogram <- pop.firingRate.df %>% ggplot() +
geom_col(aes(x = bins, y = FR), fill = "grey", color = "black") +
annotate("rect", xmin = 4*start+dt, xmax = 4*stop+dt, ymin = 0, ymax = N+0.5, fill = "purple", color ="black", alpha = 0.4)+
xlab("Time (s)") + ylab("Firing rate (Hz)") +
theme_classic()+
#facet_wrap(~stimID)+
theme(axis.text.x = element_text(angle = 45, vjust = 1.05, hjust=1))
popFR_histogram
ggsave("M1cortex_popFRhistogram.png",popFR_histogram)
FF_all <- pop.firingRate.df %>%
group_by(stimID) %>%
summarize(var(countPerNeuron)/mean(countPerNeuron))
FF_all
spike.fano <- allSpikes.df %>%
group_by(cellID) %>%
mutate(bin = cut(spikes,
breaks = .5*(0:20),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin)))) %>%
mutate(countPerNeuron = count / 10)
summarize(fano = ( var(countPerNeuron) / mean(countPerNeuron)))
spike.fano
allSpikes.df <- data.frame(spikeTimes = NULL, cellID = NULL)
# Read in data frames then bind them to the big one
spike.df <- read_csv("spikeTimes_neuron1_M1cortex.csv") %>% mutate(cellID = factor(1))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron2_M1cortex.csv") %>% mutate(cellID = factor(2))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron3_M1cortex.csv") %>% mutate(cellID = factor(3))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron4_M1cortex.csv") %>% mutate(cellID = factor(4))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron5_M1cortex.csv") %>% mutate(cellID = factor(5))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron6_M1cortex.csv") %>% mutate(cellID = factor(6))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron7_M1cortex.csv") %>% mutate(cellID = factor(7))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron8_M1cortex.csv") %>% mutate(cellID = factor(8))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron9_M1cortex.csv") %>% mutate(cellID = factor(9))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron10_M1cortex.csv") %>% mutate(cellID = factor(10))
allSpikes.df <- rbind(allSpikes.df, spike.df)
allSpikes.df <- allSpikes.df[c("spikes", "cellID")]
spike.fano <- allSpikes.df %>%
group_by(cellID) %>%
mutate(bin = cut(spikes,
breaks = .5*(0:20),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin)))) %>%
mutate(countPerNeuron = count / 10)
summarize(fano = ( var(countPerNeuron) / mean(countPerNeuron)))
spike.fano
spike.fano <- allSpikes.df %>%
group_by(cellID) %>%
mutate(bin = cut(spikes,
breaks = .5*(0:20),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin)))) %>%
mutate(countPerNeuron = count / 10)%>%
summarize(fano = ( var(countPerNeuron) / mean(countPerNeuron)))
spike.fano
################################
## This script will read in the M1 cortex data from worksheet 5 and create several plots:
############################################
# set directory:
wdd <- setwd('~/Downloads')
library('ggplot2')
library(tidyverse)
# set up empty data frame to hold spike times and cell ID
allSpikes.df <- data.frame(spikes = NULL, cellID = NULL)
# read in data
for (i in seq(1,10))
{
spike.df <- read_csv(paste0("spikeTimes_neuron",i,"_M1cortex.csv")) %>%
mutate(cellID = factor(i))
allSpikes.df <- rbind(allSpikes.df, spike.df)
}
# only keep the two columns I want: spikes and cellID
allSpikes.df <- allSpikes.df[c("spikes","cellID")]
# trial info
start <- 3.5 #start of stim  -- seconds
stop <- 4.5 #end of stim  -- seconds
T <- 10 # total time of trial -- seconds
N <- 10 # number of spike trains
##########################
### Spike raster plot ####
##########################
spikeTrain <- allSpikes.df %>%
ggplot() +
geom_tile(aes(x = spikes, y = cellID), width = 0.02, height = 0.6) +
annotate("rect", xmin = start, xmax = stop, ymin = 0, ymax = N+0.5, fill = "purple", color ="black", alpha = 0.4)+
labs(x = "Time (seconds)", y = "Cell ID", title = "Spike raster") +
theme_classic()
spikeTrain
##############################
### Firing-rate histogram ####
##############################
# population level FR histogram
# first, add a column to our data frame with a label for before, during, and after
before.df <- allSpikes.df %>%
filter(spikes<start) %>%
mutate(stimID = "before")
during.df <- allSpikes.df %>%
filter(spikes>=start & spikes <= stop) %>%
mutate(stimID = "during")
after.df <- allSpikes.df %>%
filter(spikes>stop) %>%
mutate(stimID = "after")
# put that column onto allSpikes
allSpikes.df <- rbind(before.df, during.df, after.df)
# bin width
dt <- 0.25;
pop.firingRate.df <- allSpikes.df %>%
group_by(stimID) %>%
mutate(bins = cut(spikes, breaks = seq(0,T,dt), dig.lab = 5)) %>%
summarise(count = as.vector(table(bins)), bins = as.vector(names(table(bins))))
pop.firingRate.df
allSpikes.df
dt_small <- 0.1;
synch.df <- allSpikes.df %>%
#group_by(stimID) %>%
mutate(bins = cut(spikes, breaks = seq(0,T,by = dt_small), dig.lab = 5)) %>%
summarise(count = as.vector(table(bins)), bins = as.vector(names(table(bins))))%>%
mutate(countPerNeuron = count/N) %>%
mutate(FR = count/(dt_small*N))
synchPlot<- synch.df %>% ggplot() +
geom_line(aes(x = seq(0+dt_small,T, by = dt_small), y=FR)) +
annotate("rect", xmin = start, xmax = stop, ymin = 0, ymax = 15, fill = "purple", alpha = 0.3)+
geom_segment(aes(x = start, xend = stop, y = 0, yend = 0), size = 6, color = "black")+
xlab("Time (s)") + ylab("Firing rate per neuron (Hz)") +
theme_classic()
ggsave("M1cortex_synchronyPlot.png",synchPlot)
synchPlot
beforeStim.df <- allSpikes.df %>% filter(stimID == "before")
duringStim.df <- allSpikes.df %>% filter(stimID == "during")
afterStim.df <- allSpikes.df %>% filter(stimID == "after")
# check that have all the data
nrow(allSpikes.df)
nrow(beforeStim.df) + nrow(duringStim.df) + nrow(afterStim.df)
# make ISI for each:
# ISI per cell ID
ISIbefore.df <- beforeStim.df %>%
group_by(cellID) %>%
summarise(ISI = diff(spikes))
# calculate CV
cv.before <- sd(ISIbefore.df$ISI)/mean(ISIbefore.df$ISI)
# plot ISI
ISIbefore.graph <- ISIbefore.df %>%
ggplot() +
geom_histogram(aes(x = ISI), color = "black", fill = "darkgreen", alpha = 0.6,
bins = 30) +
labs(x = "Time difference (ms)", y = "Count", title = paste("ISI - before stimulus, CV = ", round(cv.before, digits = 2))) +
theme_classic()
ISIbefore.graph
# during
ISIduring.df <- duringStim.df %>%
group_by(cellID) %>%
summarise(ISI = diff(spikes))
# calculate CV
cv.during <- sd(ISIduring.df$ISI)/mean(ISIduring.df$ISI)
ISIduring.graph <- ISIduring.df %>%
ggplot() +
geom_histogram(aes(x = ISI), color = "black", fill = "purple", alpha = 0.6,
bins = 30) +
scale_x_continuous(limits = c(0,2)) +
labs(x = "Time difference (ms)", y = "Count", title = paste("ISI - during stimulus, CV = ", round(cv.during, digits = 2)))+
theme_classic()
ISIduring.graph
# after
ISIafter.df <- afterStim.df %>%
group_by(cellID) %>%
summarise(ISI = diff(spikes))
# calculate CV
cv.after <- sd(ISIafter.df$ISI)/mean(ISIafter.df$ISI)
ISIafter.graph <- ISIafter.df %>%
ggplot() +
geom_histogram(aes(x = ISI), color = "black", fill = "darkgreen", alpha = 0.6,
bins = 30) +
labs(x = "Time difference (ms)", y = "Count", title = paste("ISI - after stimulus, CV = ", round(cv.after, digits = 2)))+
theme_classic()
ISIafter.graph
# use grid.arrange to put them together
library("gridExtra")
finalISI <- grid.arrange(ISIbefore.graph,ISIduring.graph,ISIafter.graph,nrow=3)
ggsave("M1cortex_ISIplots.png",finalISI)
pop.firingRate.df <- allSpikes.df %>%
group_by(stimID) %>%
mutate(bins = cut(spikes, breaks = seq(0,T,dt), dig.lab = 5))
pop.firingRate.df
setwd("~/Desktop/NSCI Data Science/Lab/Homework/HW 5")
# Initialize data frame --> column 1 = spike times, column 2 = neuron number
allSpikes.df <- data.frame(spikeTimes = NULL, cellID = NULL)
# Read in data frames then bind them to the big one
spike.df <- read_csv("spikeTimes_neuron1_M1cortex.csv") %>% mutate(cellID = factor(1))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron2_M1cortex.csv") %>% mutate(cellID = factor(2))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron3_M1cortex.csv") %>% mutate(cellID = factor(3))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron4_M1cortex.csv") %>% mutate(cellID = factor(4))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron5_M1cortex.csv") %>% mutate(cellID = factor(5))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron6_M1cortex.csv") %>% mutate(cellID = factor(6))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron7_M1cortex.csv") %>% mutate(cellID = factor(7))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron8_M1cortex.csv") %>% mutate(cellID = factor(8))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron9_M1cortex.csv") %>% mutate(cellID = factor(9))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron10_M1cortex.csv") %>% mutate(cellID = factor(10))
allSpikes.df <- rbind(allSpikes.df, spike.df)
allSpikes.df <- allSpikes.df[c("spikes", "cellID")]
before <- allSpikes.df %>%
filter(spikes < 3.5)  %>%
mutate(label = "before")
during <- allSpikes.df %>%
filter(spikes >= 3.5 & spikes <= 4.5 )  %>%
mutate(label = "during")
after <- allSpikes.df %>%
filter(spikes > 4.5) %>%
mutate(label = "after")
allSpikes.df <- rbind(before.df, during.df, after.df)
spike.fano <- allSpikes.df %>%
group_by(label) %>%
mutate(bin = cut(spikes,
breaks = .25*(0:40),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin))))%>%
mutate(countPerNeron = count / 10 ) %>%
mutate(firing.rate = count/(.25 * 10)) %>%
group_by(label) %>%
summarize(var(countPerNeuron)/mean(countPerNeuron))
allSpikes.df
before <- allSpikes.df %>%
filter(spikes < 3.5)  %>%
mutate(label = "before")
during <- allSpikes.df %>%
filter(spikes >= 3.5 & spikes <= 4.5 )  %>%
mutate(label = "during")
after <- allSpikes.df %>%
filter(spikes > 4.5) %>%
mutate(label = "after")
allSpikes.df <- rbind(before.df, during.df, after.df)
allSpikes.df
setwd("~/Desktop/NSCI Data Science/Lab/Homework/HW 5")
# Initialize data frame --> column 1 = spike times, column 2 = neuron number
allSpikes.df <- data.frame(spikeTimes = NULL, cellID = NULL)
# Read in data frames then bind them to the big one
spike.df <- read_csv("spikeTimes_neuron1_M1cortex.csv") %>% mutate(cellID = factor(1))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron2_M1cortex.csv") %>% mutate(cellID = factor(2))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron3_M1cortex.csv") %>% mutate(cellID = factor(3))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron4_M1cortex.csv") %>% mutate(cellID = factor(4))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron5_M1cortex.csv") %>% mutate(cellID = factor(5))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron6_M1cortex.csv") %>% mutate(cellID = factor(6))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron7_M1cortex.csv") %>% mutate(cellID = factor(7))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron8_M1cortex.csv") %>% mutate(cellID = factor(8))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron9_M1cortex.csv") %>% mutate(cellID = factor(9))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron10_M1cortex.csv") %>% mutate(cellID = factor(10))
allSpikes.df <- rbind(allSpikes.df, spike.df)
allSpikes.df <- allSpikes.df[c("spikes", "cellID")]
setwd("~/Desktop/NSCI Data Science/Lab/Homework/HW 5")
# Initialize data frame --> column 1 = spike times, column 2 = neuron number
allSpikes.df <- data.frame(spikeTimes = NULL, cellID = NULL)
# Read in data frames then bind them to the big one
spike.df <- read_csv("spikeTimes_neuron1_M1cortex.csv") %>% mutate(cellID = factor(1))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron2_M1cortex.csv") %>% mutate(cellID = factor(2))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron3_M1cortex.csv") %>% mutate(cellID = factor(3))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron4_M1cortex.csv") %>% mutate(cellID = factor(4))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron5_M1cortex.csv") %>% mutate(cellID = factor(5))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron6_M1cortex.csv") %>% mutate(cellID = factor(6))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron7_M1cortex.csv") %>% mutate(cellID = factor(7))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron8_M1cortex.csv") %>% mutate(cellID = factor(8))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron9_M1cortex.csv") %>% mutate(cellID = factor(9))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron10_M1cortex.csv") %>% mutate(cellID = factor(10))
allSpikes.df <- rbind(allSpikes.df, spike.df)
allSpikes.df <- allSpikes.df[c("spikes", "cellID")]
before <- allSpikes.df %>%
filter(spikes < 3.5)  %>%
mutate(label = "before")
during <- allSpikes.df %>%
filter(spikes >= 3.5 & spikes <= 4.5 )  %>%
mutate(label = "during")
after <- allSpikes.df %>%
filter(spikes > 4.5) %>%
mutate(label = "after")
allSpikes.df <- rbind(before.df, during.df, after.df)
# Initialize data frame --> column 1 = spike times, column 2 = neuron number
allSpikes.df <- data.frame(spikeTimes = NULL, cellID = NULL)
# Read in data frames then bind them to the big one
spike.df <- read_csv("spikeTimes_neuron1_M1cortex.csv") %>% mutate(cellID = factor(1))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron2_M1cortex.csv") %>% mutate(cellID = factor(2))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron3_M1cortex.csv") %>% mutate(cellID = factor(3))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron4_M1cortex.csv") %>% mutate(cellID = factor(4))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron5_M1cortex.csv") %>% mutate(cellID = factor(5))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron6_M1cortex.csv") %>% mutate(cellID = factor(6))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron7_M1cortex.csv") %>% mutate(cellID = factor(7))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron8_M1cortex.csv") %>% mutate(cellID = factor(8))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron9_M1cortex.csv") %>% mutate(cellID = factor(9))
allSpikes.df <- rbind(allSpikes.df, spike.df)
spike.df <- read_csv("spikeTimes_neuron10_M1cortex.csv") %>% mutate(cellID = factor(10))
allSpikes.df <- rbind(allSpikes.df, spike.df)
allSpikes.df <- allSpikes.df[c("spikes", "cellID")]
before <- allSpikes.df %>%
filter(spikes < 3.5)  %>%
mutate(label = "before")
during <- allSpikes.df %>%
filter(spikes >= 3.5 & spikes <= 4.5 )  %>%
mutate(label = "during")
after <- allSpikes.df %>%
filter(spikes > 4.5) %>%
mutate(label = "after")
allSpikes.df <- rbind(before, during, after)
spike.fano <- allSpikes.df %>%
group_by(label) %>%
mutate(bin = cut(spikes,
breaks = .25*(0:40),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin))))%>%
mutate(countPerNeron = count / 10 ) %>%
mutate(firing.rate = count/(.25 * 10)) %>%
group_by(label) %>%
summarize(var(countPerNeuron)/mean(countPerNeuron))
allSpikes.df
spike.fano
spike.fano <- allSpikes.df %>%
group_by(label) %>%
mutate(bin = cut(spikes,
breaks = .25*(0:40),
dig.lab = 5))
spike.fano <- allSpikes.df %>%
group_by(label) %>%
mutate(bin = cut(spikes,
breaks = .25*(0:40),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin))))
spike.fano
spike.fano <- allSpikes.df %>%
group_by(label) %>%
mutate(bin = cut(spikes,
breaks = .25*(0:40),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin)))) %>%
mutate(countPerNeron = count / 10 )
spike.fano
spike.fano <- allSpikes.df %>%
group_by(label) %>%
mutate(bin = cut(spikes,
breaks = .25*(0:40),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin)))) %>%
mutate(countPerNeron = count / 10 ) %>%
mutate(firing.rate = count/(.25 * 10))
spike.fano
spike.fano <- allSpikes.df %>%
group_by(label) %>%
mutate(bin = cut(spikes,
breaks = .25*(0:40),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin)))) %>%
mutate(countPerNeron = count / 10 ) %>%
mutate(firing.rate = count/(.25 * 10)) %>%
group_by(label)
spike.fano
spike.fano <- allSpikes.df %>%
group_by(label) %>%
mutate(bin = cut(spikes,
breaks = .25*(0:40),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin)))) %>%
mutate(countPerNeron = count / 10 ) %>%
mutate(firing.rate = count/(.25 * 10)) %>%
group_by(label) %>%
summarize(var(countPerNeuron)/mean(countPerNeuron))
spike.fano <- allSpikes.df %>%
group_by(label) %>%
mutate(bin = cut(spikes,
breaks = .25*(0:40),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin)))) %>%
mutate(countPerNeuron = count / 10 ) %>%
mutate(firing.rate = count/(.25 * 10)) %>%
group_by(label) %>%
summarize(var(countPerNeuron)/mean(countPerNeuron))
spike.fano
spike.fano <- allSpikes.df %>%
group_by(cellID) %>%
mutate(bin = cut(spikes,
breaks = .25*(0:40),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin))))
summarize(fano = ( var(countPerNeuron) / mean(countPerNeuron)))
spike.fano
spike.fano <- allSpikes.df %>%
group_by(cellID) %>%
mutate(bin = cut(spikes,
breaks = .25*(0:40),
dig.lab = 5)) %>%
summarise(count = as.vector(table(bin)), bin = as.vector(names(table(bin)))) %>%
summarize(fano = ( var(count) / mean(count)))
spike.fano
